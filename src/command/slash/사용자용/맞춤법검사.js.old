const hanspell = require('hanspell');
const { SlashCommandBuilder } = require('@discordjs/builders');
const { MessageEmbed } = require('discord.js');

module.exports = {
    data: new SlashCommandBuilder()
        .setName("ë§ì¶¤ë²•ê²€ì‚¬")
        .setDescription("ë§ì¶¤ë²•ì´ ë§ëŠ”ì§€ ê²€ì‚¬í•´ìš”!")
        .addStringOption(option => option
            .setName("ë¬¸êµ¬")
            .setDescription("í™•ì¸í•  ë¬¸êµ¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”!")
            .setRequired(true)),
    async run(interaction){
        await interaction.deferReply()
        const ë¬¸ì¥ = interaction.options.getString("ë¬¸êµ¬")
        if (ë¬¸ì¥.length <= 0 || !ë¬¸ì¥) {
            return interaction.editReply({
                embeds: [
                    new MessageEmbed()
                        .setColor("ORANGE")
                        .setTitle("â— ì—ëŸ¬ ë°œìƒ ERROR CODE")
                        .setDescription(`í•´ë‹¹ ë©”ì„¸ì§€ëŠ” ê²€ì‚¬ë¥¼ ì§„í–‰í•  ìˆ˜ ì—†ëŠ” í•­ëª©ì´ì—ìš”! (ì„ë² ë“œ ë“±)`)]
            })
        }
        if (ë¬¸ì¥.length >= 250) {
            return interaction.editReply({
                embeds: [
                    new MessageEmbed()
                        .setColor("ORANGE")
                        .setTitle("â— ì—ëŸ¬ ë°œìƒ ERROR CODE")
                        .setDescription(`250ì ì´ìƒì˜ ë¬¸ì¥ì€ ë§ì¶¤ë²• ê²€ì‚¬ë¥¼ í•  ìˆ˜ ì—†ì–´ìš”!`)]
            })
        }
        const end = function () {
            console.log('ë§ì¶¤ë²• ê²€ì‚¬ê¸° ì‘ë™ ì™„ë£Œ!')
        }
        const error = function (err) {
            console.error('error: ' + err)
        }
        const check = function (chk) {
            const text = new MessageEmbed()
                .setColor("#2F3136")
                .setDescription("\n**ê²€ì‚¬í•  ë¬¸ì¥**\n```" + `${ë¬¸ì¥}` + "```\n")
            if (chk.length <= 0){
                text.setTitle(`ë§ì¶¤ë²•ì´ ëª¨ë‘ ì¼ì¹˜í•´ìš”!`)
            }else{
                if(chk.length >= 5){
                    text.setTitle(`${chk.length} ê°œì˜ ë§ì¶¤ë²•ì„ í‹€ë¦¬ì…¨ì–´ìš”ã… ã…  \nì„¸ì¢…ëŒ€ì™•ë‹˜ê³¼ ì£¼ì‹œê²½ ì„ ìƒë‹˜ê»˜ì„œ í†µíƒ„í•  ë…¸ë¦‡ì…ë‹ˆë‹¤ã… ã… `)
                }else{
                    text.setTitle(`${chk.length} ê°œì˜ ë§ì¶¤ë²•ì„ í‹€ë¦¬ì…¨ì–´ìš”ã… ã… `)
                }
                chk.forEach((elem, index) => {
                    text.addField(`${elem.token} ğŸ”Š __${elem.suggestions}__`, `${elem.info}`, true)
                })
            }
            interaction.editReply({ embeds: [text] })
        }
        hanspell.spellCheckByDAUM(ë¬¸ì¥, 6000, check, end, error)
    }
}